<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created on Oktober, 3 2017 by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Maxima Manual: 67. romberg</title>

<meta name="description" content="Maxima Manual: 67. romberg">
<meta name="keywords" content="Maxima Manual: 67. romberg">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 0px; padding-bottom: 0px;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}
img {max-width:80%; max-height: 80%}
-->
</style>

<link rel="icon" href="../figures/favicon.ico"/>
</head>

<body lang="de" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="romberg"></a>
<a name="SEC356"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="maxima_66.html#SEC355" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC357" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima_66.html#SEC353" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_68.html#SEC358" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_79.html#SEC410" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 67. romberg </h1>


<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC357">67.1 Functions and Variables for romberg</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Functions-and-Variables-for-romberg"></a>
<a name="SEC357"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC356" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_68.html#SEC358" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC356" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC356" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_68.html#SEC358" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_79.html#SEC410" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 67.1 Functions and Variables for romberg </h2>

<p><a name="function_005fromberg"></a>
</p><dl>
<dt><u>Function:</u> <b>romberg</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX2564"></a>
</dt>
<dt><u>Function:</u> <b>romberg</b><i> (<var>F</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX2565"></a>
</dt>
<dd><p>Computes a numerical integration by Romberg's method.
</p>
<p><code>romberg(<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code> returns an estimate of
the integral <code>integrate(<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>.
<var>expr</var> must be an expression which evaluates to a floating point value
when <var>x</var> is bound to a floating point value.
</p>
<p><code>romberg(<var>F</var>, <var>a</var>, <var>b</var>)</code> returns an estimate of the integral
<code>integrate(<var>F</var>(x), x, <var>a</var>, <var>b</var>)</code> where <code>x</code> represents the
unnamed, sole argument of <var>F</var>; the actual argument is not named <code>x</code>.
<var>F</var> must be a Maxima or Lisp function which returns a floating point value
when the argument is a floating point value.  <var>F</var> may name a translated or
compiled Maxima function.
</p>
<p>The accuracy of <code>romberg</code> is governed by the global variables
<code><a href="#rombergabs">rombergabs</a></code> and <code><a href="#rombergtol">rombergtol</a></code>.  <code>romberg</code> terminates
successfully when the absolute difference between successive approximations is
less than <code>rombergabs</code>, or the relative difference in successive
approximations is less than <code>rombergtol</code>.  Thus when <code>rombergabs</code> is
<code>0.0</code> (the default) only the relative error test has any effect on
<code>romberg</code>.
</p>
<p><code>romberg</code> halves the stepsize at most <code><a href="#rombergit">rombergit</a></code> times before it
gives up; the maximum number of function evaluations is therefore
<code>2^rombergit</code>.  If the error criterion established by <code>rombergabs</code>
and <code>rombergtol</code> is not satisfied, <code>romberg</code> prints an error message.
<code>romberg</code> always makes at least <code><a href="#rombergmin">rombergmin</a></code> iterations; this is a
heuristic intended to prevent spurious termination when the integrand is
oscillatory.
</p>
<p><code>romberg</code> repeatedly evaluates the integrand after binding the variable
of integration to a specific value (and not before).  This evaluation policy
makes it possible to nest calls to <code>romberg</code>, to compute multidimensional
integrals.  However, the error calculations do not take the errors of nested
integrations into account, so errors may be underestimated.  Also, methods
devised especially for multidimensional problems may yield the same accuracy
with fewer function evaluations.
</p>
<p><code>load(romberg)</code> loads this function.
</p>
<p>See also <a href="maxima_16.html#SEC111">Einf&uuml;hrung in QUADPACK</a>, a collection of numerical integration
functions.
</p>
<p>Examples:
</p>
<p>A 1-dimensional integration.
</p>
<pre class="example">(%i1) load (romberg);
(%o1)    /usr/share/maxima/5.11.0/share/numeric/romberg.lisp
(%i2) f(x) := 1/((x - 1)^2 + 1/100) + 1/((x - 2)^2 + 1/1000)
              + 1/((x - 3)^2 + 1/200);
                    1                 1                1
(%o2) f(x) := -------------- + --------------- + --------------
                     2    1           2    1            2    1
              (x - 1)  + ---   (x - 2)  + ----   (x - 3)  + ---
                         100              1000              200
(%i3) rombergtol : 1e-6;
(%o3)                 9.9999999999999995E-7
(%i4) rombergit : 15;
(%o4)                          15
(%i5) estimate : romberg (f(x), x, -5, 5);
(%o5)                   173.6730736617464
(%i6) exact : integrate (f(x), x, -5, 5);
(%o6) 10 sqrt(10) atan(70 sqrt(10))
 + 10 sqrt(10) atan(30 sqrt(10)) + 10 sqrt(2) atan(80 sqrt(2))
 + 10 sqrt(2) atan(20 sqrt(2)) + 10 atan(60) + 10 atan(40)
(%i7) abs (estimate - exact) / exact, numer;
(%o7)                7.5527060865060088E-11
</pre>
<p>A 2-dimensional integration, implemented by nested calls to <code>romberg</code>.
</p>
<pre class="example">(%i1) load (romberg);
(%o1)    /usr/share/maxima/5.11.0/share/numeric/romberg.lisp
(%i2) g(x, y) := x*y / (x + y);
                                    x y
(%o2)                   g(x, y) := -----
                                   x + y
(%i3) rombergtol : 1e-6;
(%o3)                 9.9999999999999995E-7
(%i4) estimate : romberg (romberg (g(x, y), y, 0, x/2), x, 1, 3);
(%o4)                   0.81930239628356
(%i5) assume (x &gt; 0);
(%o5)                        [x &gt; 0]
(%i6) integrate (integrate (g(x, y), y, 0, x/2), x, 1, 3);
                                          3
                                    2 log(-) - 1
                    9                     2        9
(%o6)       - 9 log(-) + 9 log(3) + ------------ + -
                    2                    6         2
(%i7) exact : radcan (%);
                    26 log(3) - 26 log(2) - 13
(%o7)             - --------------------------
                                3
(%i8) abs (estimate - exact) / exact, numer;
(%o8)                1.3711979871851024E-10
</pre></dd></dl>

<p><a name="rombergabs"></a>
</p><dl>
<dt><u>Option variable:</u> <b>rombergabs</b>
<a name="IDX2566"></a>
</dt>
<dd><p>Default value: <code>0.0</code>
</p>
<p>The accuracy of <code><a href="#SEC356">romberg</a></code> is governed by the global variables
<code>rombergabs</code> and <code><a href="#rombergtol">rombergtol</a></code>.  <code>romberg</code> terminates
successfully when the absolute difference between successive approximations is
less than <code>rombergabs</code>, or the relative difference in successive
approximations is less than <code>rombergtol</code>.  Thus when <code>rombergabs</code> is
<code>0.0</code> (the default) only the relative error test has any effect on
<code>romberg</code>.
</p>
<p>See also <code><a href="#rombergit">rombergit</a></code> and <code><a href="#rombergmin">rombergmin</a></code>.
</p></dd></dl>

<p><a name="rombergit"></a>
</p><dl>
<dt><u>Option variable:</u> <b>rombergit</b>
<a name="IDX2567"></a>
</dt>
<dd><p>Default value: <code>11</code>
</p>
<p><code><a href="#SEC356">romberg</a></code> halves the stepsize at most <code>rombergit</code> times before it
gives up; the maximum number of function evaluations is therefore
<code>2^rombergit</code>.  <code>romberg</code> always makes at least <code><a href="#rombergmin">rombergmin</a></code>
iterations; this is a heuristic intended to prevent spurious termination when
the integrand is oscillatory.
</p>
<p>See also <code><a href="#rombergabs">rombergabs</a></code> and <code><a href="#rombergtol">rombergtol</a></code>.
</p></dd></dl>

<p><a name="rombergmin"></a>
</p><dl>
<dt><u>Option variable:</u> <b>rombergmin</b>
<a name="IDX2568"></a>
</dt>
<dd><p>Default value: <code>0</code>
</p>
<p><code><a href="#SEC356">romberg</a></code> always makes at least <code>rombergmin</code> iterations; this is a
heuristic intended to prevent spurious termination when the integrand is
oscillatory.
</p>
<p>See also <code><a href="#rombergit">rombergit</a></code>, <code><a href="#rombergabs">rombergabs</a></code>, and <code><a href="#rombergtol">rombergtol</a></code>.
</p></dd></dl>

<p><a name="rombergtol"></a>
</p><dl>
<dt><u>Option variable:</u> <b>rombergtol</b>
<a name="IDX2569"></a>
</dt>
<dd><p>Default value: <code>1e-4</code>
</p>
<p>The accuracy of <code><a href="#SEC356">romberg</a></code> is governed by the global variables
<code><a href="#rombergabs">rombergabs</a></code> and <code>rombergtol</code>.  <code>romberg</code> terminates successfully
when the absolute difference between successive approximations is less than
<code>rombergabs</code>, or the relative difference in successive approximations is
less than <code>rombergtol</code>.  Thus when <code>rombergabs</code> is <code>0.0</code> (the
default) only the relative error test has any effect on <code>romberg</code>.
</p>
<p>See also <code><a href="#rombergit">rombergit</a></code> and <code><a href="#rombergmin">rombergmin</a></code>.
</p></dd></dl>



<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC356" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_68.html#SEC358" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_79.html#SEC410" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Viktor T. Toth</em> on <em>Oktober, 3 2017</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
