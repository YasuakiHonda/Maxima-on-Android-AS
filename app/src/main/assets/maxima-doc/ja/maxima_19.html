<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on October, 5 2017 by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Maxima 5.41.0 Manual: 19. Integration</title>

<meta name="description" content="Maxima 5.41.0 Manual: 19. Integration">
<meta name="keywords" content="Maxima 5.41.0 Manual: 19. Integration">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 0px; padding-bottom: 0px;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}
img {max-width:80%; max-height: 80%}
-->
</style>

<link rel="icon" href="figures/favicon.ico"/>
<script type="text/javascript"><!--

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-510249-14']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

--></script>

</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<div style="position: fixed; width: 300px; right: 20px;">
<script>
  (function() {
    var cx = '010272381774241760502:zr4s1iggymk';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
</div>


<a name="Integration"></a>
<a name="SEC98"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="maxima_18.html#SEC97" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC99" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima_18.html#SEC96" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 19. Integration </h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC99">19.1 Introduction to Integration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC100">19.2 Functions and Variables for Integration</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC101">19.3 Introduction to QUADPACK</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC103">19.4 Functions and Variables for QUADPACK</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<p><a name="Item_003a-Introduction-to-Integration"></a>
</p><hr size="6">
<a name="Introduction-to-Integration"></a>
<a name="SEC99"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC98" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC100" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC98" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 19.1 Introduction to Integration </h2>

<p>Maximaは積分を扱うためのいくつかのルーチンを持っています。
<code>integrate</code>関数はそれらのほとんどを利用します。
指定されていない関数（ともちろんその導関数）を扱う <code>antid</code>パッケージもあります。
数値目的のためには
<code>quad_qag</code>, <code>quad_qags</code>などと名付けられた
QUADPACKから適応積分器一式があります。
それらは見出し <code>QUADPACK</code>の下で記述されています。
超幾何関数を扱うことができます。詳細は <code>specint</code>を参照してください。
一般的に言って、Maximaは「初等関数」（有理関数、三角関数、対数、指数関数、根号など）と
２、３の拡張（誤差関数、二重対数関数）を使った積分可能な積分だけを扱います。
<code>g(x)</code>や <code>h(x)</code>といった未知の関数を使った積分は扱いません。
</p>

<p><a name="Item_003a-Functions-and-Variables-for-Integration"></a>
</p><hr size="6">
<a name="Functions-and-Variables-for-Integration"></a>
<a name="SEC100"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC99" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC101" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC98" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 19.2 Functions and Variables for Integration </h2>


<p><a name="changevar"></a>
<a name="Item_003a-changevar"></a>
</p><dl>
<dt><u>関数:</u> <b>changevar</b><i> (<var>expr</var>, <var>f(x,y)</var>, <var>y</var>, <var>x</var>)</i>
<a name="IDX752"></a>
</dt>
<dd><p><var>x</var>に関する積分を含む <var>expr</var>の中に現れるすべての積分に関して、
<code><var>f(x,y)</var> = 0</code>で与えられる変数変換を生成します。
新しい変数は <var>y</var>です。
</p>
<p>変数の変更は<code><var>f(x)</var> = <var>g(y)</var></code>とも書けます。
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) assume(a &gt; 0)$
(%i2) 'integrate (%e**sqrt(a*y), y, 0, 4);
                      4
                     /
                     [    sqrt(a) sqrt(y)
(%o2)                I  %e                dy
                     ]
                     /
                      0
(%i3) changevar (%, y-z^2/a, z, y);
                      0
                     /
                     [                abs(z)
                   2 I            z %e       dz
                     ]
                     /
                      - 2 sqrt(a)
(%o3)            - ----------------------------
                                a
</pre></td></tr></table>
<p>上の <code>'integrate</code>の例のような名詞形を含む式は
<code>nouns</code>フラグを使って <code>ev</code>で評価できます。
例えば、上の　<code>changevar</code>が返す式は
<code>ev (%o3, nouns)</code>で評価できます。
</p>
<p><code>changevar</code>は和や積のインデックスに関する変更にも使えます。
しかし、
変更が和や積の中でなされる時
この変更はシフトすなわち <code>i = j+ ...</code>
でなければならず、高階関数ではないことをはっきり理解しなければいけません。
例えば、
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i4) sum (a[i]*x^(i-2), i, 0, inf);
                         inf
                         ====
                         \         i - 2
(%o4)                     &gt;    a  x
                         /      i
                         ====
                         i = 0
(%i5) changevar (%, i-2-n, n, i);
                        inf
                        ====
                        \               n
(%o5)                    &gt;      a      x
                        /        n + 2
                        ====
                        n = - 2
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>


<p><a name="Item_003a-dblint"></a>
</p><dl>
<dt><u>関数:</u> <b>dblint</b><i> (<var>f</var>, <var>r</var>, <var>s</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX753"></a>
</dt>
<dd><p>二重積分ルーチン。トップレベル Maximaで書かれ、翻訳され機械語にコンパイルされました。
このパッケージをアクセスするには <code>load (&quot;dblint&quot;)</code>を使ってください。
以下を計算するため xとy方向に関してシンプソンの規則方法を使います。
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">/b /s(x)
|  |
|  |    f(x,y) dy dx
|  |
/a /r(x)
</pre></td></tr></table>
<p>関数 <var>f</var>は翻訳かコンパイルされた2変数関数でなければいけなく、
<var>r</var>と <var>s</var>はそれぞれ、翻訳かコンパイルされた1変数関数でなければいけません。
一方で <var>a</var>と <var>b</var>は浮動小数点数でなければいけません。
ルーチンは xと yの区間の分割の数を決める２つのグローバル変数を持ちます:
<code>dblint_x</code>と <code>dblint_y</code>。
両方とも初期は10で、他の整数値に独立に変えることができます。
（x方向に計算される <code>2*dblint_x+1</code>点があり、
y方向に計算される <code>2*dblint_y+1</code>点があります）
ルーチンはX軸を更に分割します。
Xのそれぞれの値に関して、最初、
<code><var>r</var>(x)</code>と <code><var>s</var>(x)</code>を計算します;
そして <code><var>r</var>(x)</code>と <code><var>s</var>(x)</code>の間でY軸が更に分割され、
シンプソン規則を使ってY軸に沿っての積分が実行されます;
そして、
シンプソン規則を使って Y積分である関数値を用いて X軸に沿っての積分が実行されます;
この手続きは様々な理由のため数値的に不安定かもしれませんが、
かなり速いです:
非常に振動的な関数や特異点（領域内の極や分岐点）を持つ関数にこれを使うことは避けてください。
Y積分は <code><var>r</var>(x)</code>と <code><var>s</var>(x)</code>がどこくらい離れているかに依存します。
だからもし距離 <code><var>s</var>(x) - <var>r</var>(x)</code>が Xに関して急速に変化するなら、
様々な Y積分で異なるステップサイズでの切り詰めから起こる本質的なエラーがあるかもしれません。
領域の範囲を改善するために <code>dblint_x</code>と <code>dblint_y</code>を増やすことができますが、
計算時間という犠牲を払うことになります。
関数値を保存しないので、関数が非常に時間がかかるものの場合、
もし何か変えたら再計算を待たなければいけません（すいません）。
関数 <var>f</var>, <var>r</var>, <var>s</var>は
<code>dblint</code>コールの前に翻訳かコンパイルされるかどちらかが要求されます。
これは多くの場合、インタープリタコードに対して桁違いの速度改善がなされるでしょう！
</p>
<p><code>demo (dblint)</code>は
実例問題に適用された <code>dblint</code>のデモンストレーションを実行します。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>

<p><a name="defint"></a>
<a name="Item_003a-defint"></a>
</p><dl>
<dt><u>関数:</u> <b>defint</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX754"></a>
</dt>
<dd><p>定積分を計算しようとします。
<code>integrate</code>は、
積分の範囲が指定された時、
すなわち <code>integrate</code>が
<code>integrate (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>としてコールされた時、
<code>defint</code>をコールします。
</p>
<p>このようにユーザーの観点からは <code>integrate</code>をコールすれば十分です。
</p>
<p><code>defint</code>はシンボリック式、計算された積分または積分の名詞形を返します。
定積分の数値近似に関しては <code>quad_qag</code>と関連関数を参照してください。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>

<p><a name="erfflag"></a>
<a name="Item_003a-erfflag"></a>
</p><dl>
<dt><u>オプション変数:</u> <b>erfflag</b>
<a name="IDX755"></a>
</dt>
<dd><p>デフォルト値: <code>true</code>
</p>
<p><code>erfflag</code>が <code>false</code>の時、
もし始めから被積分に何もないなら
(if there were none in the integrad to begin with)
<code>risch</code>が答えの中に <code>erf</code>関数を導入することを抑制します。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>


<p><a name="ilt"></a>
<a name="Item_003a-ilt"></a>
</p><dl>
<dt><u>関数:</u> <b>ilt</b><i> (<var>expr</var>, <var>s</var>, <var>t</var>)</i>
<a name="IDX756"></a>
</dt>
<dd><p><var>expr</var>の <var>s</var>とパラメータ <var>t</var>に関する逆ラプラス変換を計算します。
<var>expr</var>は分子が線形２次因子だけを持つ多項式の比でなければいけません。
<code>solve</code>か <code>linsolve</code>と合わせて
関数 <code>laplace</code>や <code>ilt</code>を使うことによって
ユーザーは微分方程式または畳み込み積分方程式やそれらの組を解くことができます。
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) 'integrate (sinh(a*x)*f(t-x), x, 0, t) + b*f(t) = t**2;
              t
             /
             [                                    2
(%o1)        I  f(t - x) sinh(a x) dx + b f(t) = t
             ]
             /
              0
(%i2) laplace (%, t, s);
                               a laplace(f(t), t, s)   2
(%o2)  b laplace(f(t), t, s) + --------------------- = --
                                       2    2           3
                                      s  - a           s
(%i3) linsolve ([%], ['laplace(f(t), t, s)]);
                                        2      2
                                     2 s  - 2 a
(%o3)     [laplace(f(t), t, s) = --------------------]
                                    5         2     3
                                 b s  + (a - a  b) s
(%i4) ilt (rhs (first (%)), s, t);
Is  a b (a b - 1)  positive, negative, or zero?

pos;
               sqrt(a b (a b - 1)) t
        2 cosh(---------------------)       2
                         b               a t
(%o4) - ----------------------------- + -------
              3  2      2               a b - 1
             a  b  - 2 a  b + a

                                                       2
                                             + ------------------
                                                3  2      2
                                               a  b  - 2 a  b + a
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Laplace-transform">Laplace transform</a>
</div>
</p></dd></dl>

<p><a name="intanalysis"></a>
<a name="Item_003a-intanalysis"></a>
</p><dl>
<dt><u>オプション変数:</u> <b>intanalysis</b>
<a name="IDX757"></a>
</dt>
<dd><p>デフォルト値: <code>true</code>
</p>
<p><code>true</code>の時、定積分が積分区間内の被積分関数の極を見つけようとします。
もしあるなら、積分は主値積分として適切に評価されます。
もしintanalysisが <code>false</code>なら、
このチェックは実行されず積分は極がないことを仮定して実行されます。
</p>
<p><code><a href="#ldefint">ldefint</a></code>も参照してください。
</p>
<p>例:
</p>
<p><code><a href="#intanalysis">intanalysis</a></code>が <code>false</code>に設定されている時
Maximaは以下の積分を解くことができます:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) integrate(1/(sqrt(x)+1),x,0,1);
                                1
                               /
                               [       1
(%o1)                          I  ----------- dx
                               ]  sqrt(x) + 1
                               /
                                0

(%i2) integrate(1/(sqrt(x)+1),x,0,1),intanalysis:false;
(%o2)                            2 - 2 log(2)

(%i3) integrate(cos(a)/sqrt((tan(a))^2 +1),a,-%pi/2,%pi/2);
The number 1 isn't in the domain of atanh
 -- an error. To debug this try: debugmode(true);

(%i4) intanalysis:false$
(%i5) integrate(cos(a)/sqrt((tan(a))^2+1),a,-%pi/2,%pi/2);
                                      %pi
(%o5)                                 ---
                                       2
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>

<p><a name="integrate"></a>
<a name="Item_003a-integrate"></a>
</p><dl>
<dt><u>関数:</u> <b>integrate</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>integrate</tt> (<var>expr</var>, <var>x</var>) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>integrate</tt> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX758"></a>
</dt>
<dd><p><var>x</var>に関する <var>expr</var>の積分をシンボリックに計算しようとします。
<code>integrate (<var>expr</var>, <var>x</var>)</code>は不定積分で、
<code>integrate (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>は
<var>a</var>,<var>b</var>の上限下限を持つ定積分です。
上限下限は <var>x</var>を含んではいけません。
しかし <code>integrate</code>はこの制限を強制するわけではありません。
<var>a</var>は <var>b</var>より小さい必要はありません。
<var>b</var>が <var>a</var>と等しいなら <code>integrate</code>は0を返します。
</p>
<p>定積分の数値近似に関しては <code>quad_qag</code>と関連関数を参照してください。
（複素積分）留数の計算に関しては <code>residue</code>を参照してください。
不定積分の代替計算方法に関しては <code>antid</code>を参照してください。
</p>
<p><code>integrate</code>が成功したら積分（<code>integrate</code>を含まない式）を返します。
そうでないなら、積分の名詞形式（クォートされた演算子
<code>'integrate</code>)もしくは１つ以上の名詞形式を含む式を返します。
<code>integrate</code>の名詞形式は積分記号で表示されます。
</p>
<p>いくつかの環境では、例えば <code>'integrate (<var>expr</var>, <var>x</var>)</code>のような
シングルクオートされた<code>integrate</code>で手動で名詞形式を構成することが役に立ちます。
例えば、積分はまだ計算されていないいくつかのパラメータに依存しているかもしれません。
<code>ev (<var>i</var>, nouns)</code>を使って積分の名詞をその引数に利用することができます。
ここで <var>i</var>は問題の名詞形式です。
(The noun may be applied to its arguments by <code>ev (<var>i</var>, nouns)</code> where i is the noun form of interest.)
<code>integrate</code>は不定積分とは別に定積分を扱います。
それぞれの場合を扱うため ある範囲の発見法を用意しています。
定積分の特別な場合は 0や無限大に等しい積分の下限上限を含んだり、
0や<code>%pi</code>や<code>2 %pi</code>に等しい下限上限を持つ三角関数を含んだり、
有理関数やベータやプサイ関数の定義に関連した積分やいくつかの対数的な積分、三角関数積分を含んだりします。
有理関数の処理は留数の計算を含むかもしれません。
もし適用可能な特殊な場合が見つからないなら
不定積分を計算し下限上限でそれを評価しようとするでしょう。
これは下限上限に無限大の極限を取ることを含みます。
<code><a href="#ldefint">ldefint</a></code>も参照してください。
</p>
<p>不定積分の特殊な場合は三角関数、指数対数関数、有理関数を含みます。
<code>integrate</code>は初等積分の短いテーブルもまた利用しています。
</p>
<p>もし非積分関数が形式 <code>f(g(x)) * diff(g(x), x)</code>を持つなら
<code>integrate</code>は変数の交換を実行します。
<code>integrate</code>は <code>g(x)</code>の導関数が非積分関数を割るような部分式
<code>g(x)</code>を見つけようとします。
この探索は <code>gradef</code>関数が定義した導関数を利用します。
<code><a href="#changevar">changevar</a></code>や <code><a href="maxima_18.html#antid">antid</a></code>も参照ください。
</p>
<p>もしこれまでの発見法のどれも不定積分を見つけられないなら
リッシュのアルゴリズムを実行します。
フラグ <code><a href="#risch">risch</a></code>が
<code>ev</code>のコールやコマンドライン上で <code>evflag</code>として設定されるかもしれません。
例えば <code>ev (integrate (<var>expr</var>, <var>x</var>), risch)</code>や
<code>integrate (<var>expr</var>, <var>x</var>), risch</code>というようにです。
もし <code>risch</code>が <code>true</code>なら
<code>integrate</code>は発見法を最初に試さずに <code><a href="#risch">risch</a></code>関数をコールします。
<code><a href="#risch">risch</a></code>も参照ください。
</p>
<p><code>integrate</code>は <code>f(x)</code>記法で明示的に表現された関数関係に対してだけ機能します。
<code>integrate</code>は <code>depends</code>関数が規定した陰の依存性を考慮しません。
</p>
<p><code>integrate</code>は非積分関数のパラメータのある性質を知っている必要がある場合があります。
<code>integrate</code>は <code>assume</code>データベースを最初に参照し、
注目の変数がそこにないなら <code>integrate</code>はユーザーに問い合わせます。
質問に依存して、適切な応答は <code>yes;</code>や<code>no;</code>, <code>pos;</code>, <code>zero;</code>,
<code>neg;</code>などです。
</p>
<p><code>integrate</code>は線形には宣言されていません。
<code>declare</code>と <code>linear</code>を参照ください。
</p>
<p><code>integrate</code>は２、３の特集な場合だけ、部分積分を企てます。
</p>
<p>例:
</p>
<ul>
<li>
初等不定積分、定積分

<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) integrate (sin(x)^3, x);
                           3
                        cos (x)
(%o1)                   ------- - cos(x)
                           3
(%i2) integrate (x/ sqrt (b^2 - x^2), x);
                                 2    2
(%o2)                    - sqrt(b  - x )
(%i3) integrate (cos(x)^2 * exp(x), x, 0, %pi);
                               %pi
                           3 %e      3
(%o3)                      ------- - -
                              5      5
(%i4) integrate (x^2 * exp(-x^2), x, minf, inf);
                            sqrt(%pi)
(%o4)                       ---------
                                2
</pre></td></tr></table>
</li><li>
<code>assume</code>と対話的問い合わせの利用

<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) assume (a &gt; 1)$
(%i2) integrate (x**a/(x+1)**(5/2), x, 0, inf);
    2 a + 2
Is  -------  an integer?
       5

no;
Is  2 a - 3  positive, negative, or zero?

neg;
                                   3
(%o2)                  beta(a + 1, - - a)
                                   2
</pre></td></tr></table>
</li><li>
変数変換。この例では２回変数変換があります。
<code>gradef</code>が規定した導関数を使ったものと未知関数
<code>r(x)</code>の微分 <code>diff(r(x))</code>を使ったもの。

<table><tr><td>&nbsp;</td><td><pre class="example">(%i3) gradef (q(x), sin(x**2));
(%o3)                         q(x)
(%i4) diff (log (q (r (x))), x);
                      d               2
                     (-- (r(x))) sin(r (x))
                      dx
(%o4)                ----------------------
                            q(r(x))
(%i5) integrate (%, x);
(%o5)                     log(q(r(x)))
</pre></td></tr></table>
</li><li>
<code>'integrate</code>名詞形を含む戻り値。
この例では Maximaは有理関数の分母の因子1つを抽出できますが、
残りを因数分解できず、いずれにせよ積分を見つけられません。
<code>grind</code>は結果の中に名詞形 <code>'integrate</code>を出力します。
積分や有理関数について更に知るには <code><a href="#integrate_005fuse_005frootsof">integrate_use_rootsof</a></code>も参照ください。

<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) expand ((x-4) * (x^3+2*x+1));
                    4      3      2
(%o1)              x  - 4 x  + 2 x  - 7 x - 4
(%i2) integrate (1/%, x);
                              /  2
                              [ x  + 4 x + 18
                              I ------------- dx
                              ]  3
                 log(x - 4)   / x  + 2 x + 1
(%o2)            ---------- - ------------------
                     73               73
(%i3) grind (%);
log(x-4)/73-('integrate((x^2+4*x+18)/(x^3+2*x+1),x))/73$
</pre></td></tr></table>
</li><li>
積分を使った関数の定義。
関数の本体は関数を定義する時には評価されません。
この例では <code>f_1</code>の本体が <code>integrate</code>の名詞形を含みます。
クォートクォート演算子<code>''</code>があると積分が評価され、その結果が
<code>f_2</code>の本体になります。

<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) f_1 (a) := integrate (x^3, x, 1, a);
                                     3
(%o1)           f_1(a) := integrate(x , x, 1, a)
(%i2) ev (f_1 (7), nouns);
(%o2)                          600
(%i3) /* Note parentheses around integrate(...) here */
      f_2 (a) := ''(integrate (x^3, x, 1, a));
                                   4
                                  a    1
(%o3)                   f_2(a) := -- - -
                                  4    4
(%i4) f_2 (7);
(%o4)                          600
</pre></td></tr></table></li></ul>

<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>

<p><a name="integration_005fconstant"></a>
<a name="Item_003a-integration_005fconstant"></a>
</p><dl>
<dt><u>システム変数:</u> <b>integration_constant</b>
<a name="IDX759"></a>
</dt>
<dd><p>デフォルト値: <code>%c</code>
</p>
<p>等式の不定積分が積分定数を導入し、
<code>integration_constant</code>と
<code>integration_constant_counter</code>を連結することで定数名を構成します。
</p>
<p><code>integration_constant</code>には任意のシンボルに割り当てられます。
</p>
<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) integrate (x^2 = 1, x);
                           3
                          x
(%o1)                     -- = x + %c1
                          3
(%i2) integration_constant : 'k;
(%o2)                           k
(%i3) integrate (x^2 = 1, x);
                            3
                           x
(%o3)                      -- = x + k2
                           3
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>

<p><a name="integration_005fconstant_005fcounter"></a>
<a name="Item_003a-integration_005fconstant_005fcounter"></a>
</p><dl>
<dt><u>システム変数:</u> <b>integration_constant_counter</b>
<a name="IDX760"></a>
</dt>
<dd><p>デフォルト値: 0
</p>
<p>等式の不定積分が積分定数を導入する時、
<code>integration_constant</code>と
<code>integration_constant_counter</code>を連結することで定数を構成します。
</p>
<p><code>integration_constant_counter</code>は次の積分定数を構成する前に増分されます。
</p>
<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) integrate (x^2 = 1, x);
                           3
                          x
(%o1)                     -- = x + %c1
                          3
(%i2) integrate (x^2 = 1, x);
                           3
                          x
(%o2)                     -- = x + %c2
                          3
(%i3) integrate (x^2 = 1, x);
                           3
                          x
(%o3)                     -- = x + %c3
                          3
(%i4) reset (integration_constant_counter);
(%o4)            [integration_constant_counter]
(%i5) integrate (x^2 = 1, x);
                           3
                          x
(%o5)                     -- = x + %c1
                          3
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p>
</dd></dl>

<p><a name="integrate_005fuse_005frootsof"></a>
<a name="Item_003a-integrate_005fuse_005frootsof"></a>
</p><dl>
<dt><u>オプション変数:</u> <b>integrate_use_rootsof</b>
<a name="IDX761"></a>
</dt>
<dd><p>デフォルト値: <code>false</code>
</p>
<p><code>integrate_use_rootsof</code>が <code>true</code>でかつ有理関数の分子が因数分解できない時、
<code>integrate</code>は分子の（まだ知られていない）根上の和という形式で積分を返します。
</p>
<p>例えば
<code>integrate_use_rootsof</code>を <code>false</code>に設定すると、
<code>integrate</code>は有理関数の未解決積分を名詞形で返します:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) integrate_use_rootsof: false$
(%i2) integrate (1/(1+x+x^5), x);
        /  2
        [ x  - 4 x + 5
        I ------------ dx                            2 x + 1
        ]  3    2                2            5 atan(-------)
        / x  - x  + 1       log(x  + x + 1)          sqrt(3)
(%o2)   ----------------- - --------------- + ---------------
                7                 14             7 sqrt(3)
</pre></td></tr></table>
<p>さあ、フラグを <code>true</code>に設定し、
積分の未解決部分を有理関数の分子の根上の和として表現しましょう:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i3) integrate_use_rootsof: true$
(%i4) integrate (1/(1+x+x^5), x);
      ====        2
      \       (%r4  - 4 %r4 + 5) log(x - %r4)
       &gt;      -------------------------------
      /                    2
      ====            3 %r4  - 2 %r4
                        3      2
      %r4 in rootsof(%r4  - %r4  + 1, %r4)
(%o4) ----------------------------------------------------------
               7

                                                      2 x + 1
                                  2            5 atan(-------)
                             log(x  + x + 1)          sqrt(3)
                           - --------------- + ---------------
                                   14             7 sqrt(3)
</pre></td></tr></table>
<p>代わりにユーザーは別々に分子の根を計算できます。
例えば、もし分子が3次多項式なら
<code>1/((x - a)*(x - b)*(x - c))</code>とか
<code>1/((x^2 - (a+b)*x + a*b)*(x - c))</code>というように
これらの根を使って被積分関数を表現できます。
これは時々 Maximaがもっと役立つ結果を得るのを助けます。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p>
</dd></dl>


<p><a name="ldefint"></a>
<a name="Item_003a-ldefint"></a>
</p><dl>
<dt><u>関数:</u> <b>ldefint</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX762"></a>
</dt>
<dd><p><var>expr</var>の <var>x</var>に関する不定積分を上限 <var>b</var>と下限 <var>a</var>で評価するために、
<code>limit</code>を使って <var>expr</var>の定積分を計算しようとします。
もし定積分を計算するのに失敗したなら、
<code>ldefint</code>は名詞形として極限を含む式を返します。
</p>
<p><code>ldefint</code>は <code>integrate</code>からコールされません。
なので、
<code>ldefint (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>
を実行することは
<code>integrate (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</code>
とは違った結果をもたらすかもしれません。
<code>ldefint</code>は定積分を評価するためにいつも同じ方法を使いますが、
<code>integrate</code>は様々な発見的方法を利用し、いくつかの特殊な場合を認識することもあります。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>


<p><a name="potential"></a>
<a name="Item_003a-potential"></a>
</p><dl>
<dt><u>関数:</u> <b>potential</b><i> (<var>givengradient</var>)</i>
<a name="IDX763"></a>
</dt>
<dd><p>計算にはグローバル変数<code>potentialzeroloc[0]</code>を利用します。
それは <code>nonlist</code>か形式
</p><table><tr><td>&nbsp;</td><td><pre class="example">[indeterminatej=expressionj, indeterminatek=expressionk, ...]
</pre></td></tr></table><p>でなければいけません。
ここで前者 (<code>nonlist</code>)は後者(リスト形式)の中の右辺すべてに関して
nonlist式とすることと同値です。
示された右辺は積分の下限として使われます。
積分が成功するかどうかはそれらの値と順序に依存するかもしれません。
<code>potentialzeroloc</code>は0に初期化されます。
</p>
</dd></dl>

<p><a name="residue"></a>
<a name="Item_003a-residue"></a>
</p><dl>
<dt><u>関数:</u> <b>residue</b><i> (<var>expr</var>, <var>z</var>, <var>z_0</var>)</i>
<a name="IDX764"></a>
</dt>
<dd><p>変数 <var>z</var>が値 <var>z_0</var>を仮定する時、
式 <var>expr</var>の複素平面での留数を計算します。
留数は <var>expr</var>のローラン級数における
<code>(<var>z</var> - <var>z_0</var>)^(-1)</code>の係数です。
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) residue (s/(s**2+a**2), s, a*%i);
                                1
(%o1)                           -
                                2
(%i2) residue (sin(a*x)/x**4, x, 0);
                                 3
                                a
(%o2)                         - --
                                6
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a> &middot;
<a href="maxima_106.html#Category_003a-Complex-variables">Complex variables</a>
</div>
</p></dd></dl>

<p><a name="risch"></a>
<a name="Item_003a-risch"></a>
</p><dl>
<dt><u>関数:</u> <b>risch</b><i> (<var>expr</var>, <var>x</var>)</i>
<a name="IDX765"></a>
</dt>
<dd><p>リッシュアルゴリズムの超越な場合を使って <var>expr</var>を <var>x</var>に関して積分します。
（リッシュアルゴリズムの代数的な場合は実装されていません。）
これは現在、
<code>integrate</code>の主要部が対応できない入れ子の指数関数や対数関数の場合を扱います。
<code>integrate</code>は、これらの場合が与えられたなら自動的に <code>risch</code>を適用します。
</p>
<p><code>erfflag</code>を <code>false</code>にすると、
もしそもそも被積分関数になにもないなら、
<code>risch</code>が答えの中に <code>erf</code>関数を導入することを抑制します。
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) risch (x^2*erf(x), x);
                                                        2
             3                      2                - x
        %pi x  erf(x) + (sqrt(%pi) x  + sqrt(%pi)) %e
(%o1)   -------------------------------------------------
                              3 %pi
(%i2) diff(%, x), ratsimp;
                             2
(%o2)                       x  erf(x)
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>


<p><a name="tldefint"></a>
<a name="Item_003a-tldefint"></a>
</p><dl>
<dt><u>関数:</u> <b>tldefint</b><i> (<var>expr</var>, <var>x</var>, <var>a</var>, <var>b</var>)</i>
<a name="IDX766"></a>
</dt>
<dd><p><code>tlimswitch</code>が <code>true</code>に設定されている <code>ldefint</code>と同値です。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a>
</div>
</p></dd></dl>


<p><a name="Item_003a-Introduction-to-QUADPACK"></a>
</p><hr size="6">
<a name="Introduction-to-QUADPACK"></a>
<a name="SEC101"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC100" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC102" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC98" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 19.3 Introduction to QUADPACK </h2>


<p>QUADPACKは１次元定積分の数値計算のための関数のコレクションです。
R. Piessens <a name="DOCF1" href="maxima_fot.html#FOOT1">(1)</a>,
E. de Doncker <a name="DOCF2" href="maxima_fot.html#FOOT2">(2)</a>,
C. Ueberhuber <a name="DOCF3" href="maxima_fot.html#FOOT3">(3)</a>,
D. Kahaner <a name="DOCF4" href="maxima_fot.html#FOOT4">(4)</a>.
の合同プロジェクトから始まりました。
</p>
<p>Maximaに含まれる QUADPACKライブラリは、
SLATEC共通数学ライブラリ バージョン
4.1<a name="DOCF5" href="maxima_fot.html#FOOT5">(5)</a>に現れる
QUADPACKの Fortranのソースコードの(プログラム<code>f2cl</code>による)自動翻訳です。
</p>
<p>SLATECライブラリは1993年7月付ですが、QUADPACK関数は何年か前に書かれました。
QUADPACKももう１つのバージョンが
Netlib <a name="DOCF6" href="maxima_fot.html#FOOT6">(6)</a>にあります;
このバージョンが SLATECバージョンとどう違うのかはっきりしません。
</p>
<p>Maximaに含まれる QUADPACK関数は、
これらの関数が不特定の回数の関数の評価を要求し、
指定された精度まで結果を計算しようとする意味で、
すべて自動です。
Maximaの QUADPACKの Lisp翻訳はいくつかの自動でない関数も含みますが、
それらは Maximaレベルで公開されていません。
</p>
<p>QUADPACKについての更なる情報は QUADPACK本
<a name="DOCF7" href="maxima_fot.html#FOOT7">(7)</a>
の中に見つけることができます。
</p>
<hr size="6">
<a name="SEC102"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC101" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC103" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC101" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection"> 19.3.1 Overview </h3>

<dl compact="compact">
<dt> <code>quad_qag</code></dt>
<dd><p>一般関数の有限の区間上の積分。
<code>quad_qag</code>は
Aind(Piessens, 1973)の戦略を使った簡単な大域的適応積分器を実装しています。
呼び出し側はルール評価コンポーネントを
ガウスークロンロッドの求積公式の6つのペアの中から選ぶことができます。
強く振動する非積分関数には高次のルールが適切です。
</p>
</dd>
<dt> <code>quad_qags</code></dt>
<dd><p>一般関数の有限の区間上の積分。
<code>quad_qags</code>はイプシロンアルゴリズム(Wynn, 1956)による外挿
(de Doncker,1978)を使った大域的適応積分器を実装しています。
</p>
</dd>
<dt> <code>quad_qagi</code></dt>
<dd><p>一般関数の無限のもしくは半無限の区間上の積分。
区間を有限の区間上に写像し、 <code>quad_qags</code>の中で使うのと同じ戦略を適用します。
</p>
</dd>
<dt> <code>quad_qawo</code></dt>
<dd><p><em>cos(omega x) f(x)</em>
や
<em>sin(omega x) f(x)</em>
の有限の区間上の積分。
ここで、
<em>omega</em>
は定数です。
規則評価構成要素は変形 Clenshaw-Curtis手法に基づいています。
<code>quad_qawo</code>は <code>quad_qags</code>に似て、外挿とともに適応再分割を適用します。
</p>
</dd>
<dt> <code>quad_qawf</code></dt>
<dd><p>フーリエコサイン変換かフーリエサイン変換を半無限区間上で計算します。
<code>quad_qawo</code>で使うのと同じアプローチを連続する区間に適用し、
イプシロンアルゴリズム(Wynn, 1956)を使った収束の促進を積分寄与の級数に適用します。
</p>
</dd>
<dt> <code>quad_qaws</code></dt>
<dd><p><em>w(x) f(x)</em>
の有限区間
<em>[a, b]</em>
上の積分。
ここで、
<em>w</em>
は形式
<em>(x - a)^alpha (b - x)^beta v(x)</em>
の関数で、
<em>v(x)</em>
は、
1, <em>log(x - a)</em>, <em>log(b - x)</em>, <em>log(x - a) log(b - x)</em>
のいずれかであり、
<em>alpha &gt; -1</em>
かつ
<em>beta &gt; -1</em>
です。
</p>
<p>大域的適応再分割戦略を適用し、
<em>a</em>か <em>b</em>を含む部分区間上では変形
Clenshaw-Curtis積分を使います。
</p>
</dd>
<dt> <code>quad_qawc</code></dt>
<dd><p><em>f(x)/(x - c)</em>のコーシーの主値を有限の区間
<em>(a, b)</em>上で指定された <em>c</em>を用いて計算します。
戦略は大域的適応的で、
点 <em>x = c</em>を含む部分範囲上で変形 Clenshaw-Curtis積分を使います。
</p>
</dd>
<dt> <code>quad_qagp</code></dt>
<dd><p>基本的に <code>quad_qags</code>と同様ですが、被積分関数の特異点や不連続点を
提供しなければいけません。
これは積分器がよい解を生成するのをより容易にします。
</p></dd>
</dl>


<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Integral-calculus">Integral calculus</a> &middot;
<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Share-packages">Share packages</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p>
<p><a name="Item_003a-Functions-and-Variables-for-QUADPACK"></a>
</p><hr size="6">
<a name="Functions-and-Variables-for-QUADPACK"></a>
<a name="SEC103"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC102" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC98" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 19.4 Functions and Variables for QUADPACK </h2>


<p><a name="quad_005fqag"></a>
<a name="Item_003a-quad_005fqag"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qag</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qag</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>key</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qag</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>key</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX767"></a>
</dt>
<dd><p>一般関数の有限の区間上の積分。
<code>quad_qag</code>は Aind(Piessens, 1973)の戦略を使った
簡単な大域的適応積分器を実装しています。
呼び出し側はルール評価コンポーネントを
ガウスークロンロッドの求積公式の6つのペアの中から選ぶことができます。
強く振動する非積分関数には高次のルールが適切です。
</p>
<p>quad_qagは積分
<em>integrate (f(x), x, a, b)</em>
を計算します。
</p>
<p>非積分関数は依存変数 <var>x</var>の <var>f(x)</var>であり、
関数は下限 <var>a</var>上限 <var>b</var>の間で積分されます。
<var>key</var>は利用する積分器で、 1から 6までのいずれかの整数でなければなりません。
<var>key</var>の値はガウスークロンロッドの積分ルールの次数を選びます。
高次のルールが強く振動する非積分関数には適切です。
</p>
<p>非積分関数は Maximaか Lisp関数か 演算子の名前であるか Maximaのラムダ式か一般的な
Maximaの式として指定することができます。
</p>
<p>数値積分は、望まれる精度を達成するまで
積分領域を部分区間に分割することによって適応的に実行されます。
</p>
<p>キーワード引数はオプションで、どの次数においても指定できます。
それらは形式 <code>key=val</code>を取ります。キーワード引数は：
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。 limitは使用する部分区間の最大数。デフォルトは200。
</p></dd>
</dl>

<p><code>quad_qag</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード（戻り値の４番目の要素）は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p>
</dd>
</dl>


<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qag (x^(1/2)*log(1/x), x, 0, 1, 3, 'epsrel=5d-8);
(%o1)    [.4444444444492108, 3.1700968502883E-9, 961, 0]
(%i2) integrate (x^(1/2)*log(1/x), x, 0, 1);
                                4
(%o2)                           -
                                9
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqags"></a>
<a name="Item_003a-quad_005fqags"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qags</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qags</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qags</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX768"></a>
</dt>
<dd><p>一般関数の有限の区間上の積分。
<code>quad_qags</code>はイプシロンアルゴリズム (Wynn, 1956)による外挿
(de Doncker,1978)を使った大域的適応積分器を実装しています。
</p>
<p><code>quad_qags</code>は、積分
</p>
<p><em>integrate (f(x), x, a, b)</em>
を計算します。
</p>
<p>非積分関数は従属変数 <var>x</var>の関数 <var>f(x)</var>であり、
関数は下限 <var>a</var>上限 <var>b</var>の間で積分されます。
</p>
<p>非積分関数は、Maximaか Lisp関数か 演算子の名前であるか Maximaのラムダ式か一般的な
Maximaの式として指定することができます。
</p>
<p>キーワード引数はオプションで、どの次数においても指定できます。
それらは形式 <code>key=val</code>を取ります。キーワード引数は：
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。 limitは使用する部分区間の最大数。デフォルトは200。
</p></dd>
</dl>

<p><code>quad_qags</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード（戻り値の４番目の要素）は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p></dd>
</dl>


<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qags (x^(1/2)*log(1/x), x, 0, 1, 'epsrel=1d-10);
(%o1)   [.4444444444444448, 1.11022302462516E-15, 315, 0]
</pre></td></tr></table>
<p>この積分に関しては <code>quad_qags</code>は
<code>quad_qag</code>よりも精確で効率的であることに注意してください。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqagi"></a>
<a name="Item_003a-quad_005fqagi"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qagi</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qagi</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qagi</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX769"></a>
</dt>
<dd><p>一般関数の無限のもしくは半無限の区間上の積分。
区間を有限の区間上に写像し、 <code>quad_qags</code>の中で使うのと同じ戦略を適用します。
</p>
<p><code>quad_qagi</code>は Quadpack QAGIルーチンを使って以下の積分の１つを評価します。
</p>
<p><em>integrate (f(x), x, a, inf)</em>
</p>
<p><em>integrate (f(x), x, minf, a)</em>
</p>
<p><em>integrate (f(x), x, minf, inf)</em>
</p>
<p>被積分関数は従属変数 <var>x</var>の関数 <var>f(x)</var>であり、無限範囲上で積分されます。
</p>
<p>被積分関数は Maximaか Lispの関数か演算子の名前であるか、
Maximaのラムダ式か Maximaの一般式として指定することができます。
</p>
<p>積分の境界の１つは無限でなければいけません。
もしそうでないなら <code>quad_qagi</code>はただ名詞形を返します。
</p>
<p>キーワード引数は随意で、任意の順序で指定できます。
それらすべては形式 <code>key=val</code>を取ります。
キーワード引数は:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。 limitは使用する部分区間の最大数。デフォルトは200。
</p></dd>
</dl>

<p><code>quad_qagi</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p></dd>
</dl>


<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qagi (x^2*exp(-4*x), x, 0, inf, 'epsrel=1d-8);
(%o1)        [0.03125, 2.95916102995002E-11, 105, 0]
(%i2) integrate (x^2*exp(-4*x), x, 0, inf);
                               1
(%o2)                          --
                               32
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqawc"></a>
<a name="Item_003a-quad_005fqawc"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qawc</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawc</tt> (<var>f(x)</var>, <var>x</var>, <var>c</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawc</tt> (<var>f</var>, <var>x</var>, <var>c</var>, <var>a</var>, <var>b</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX770"></a>
</dt>
<dd><p><em>f(x)/(x - c)</em>のコーシーの主値を有限の区間
<em>(a, b)</em>上で指定された <em>c</em>を用いて計算します。
戦略は大域的適応的で、点
<em>x = c</em>を含む部分範囲上で変形 Clenshaw-Curtis積分を使います。
</p>
<p><code>quad_qawc</code>は Quadpack QAWCルーチンを使って、
<em>integrate (f(x)/(x - c), x, a, b)</em>
</p>
<p>のコーシーの主値を計算します。
</p>
<p>被積分関数は従属変数 <var>x</var>の関数 <code><var>f(x)</var>/(<var>x</var> - <var>c</var>)</code>で、
関数は <var>a</var>から <var>b</var>までの区間上で積分されます。
</p>
<p>被積分関数は Maximaか Lispの関数か演算子の名前であるか、
Maximaのラムダ式か Maximaの一般式として指定することができます。
</p>
<p>キーワード引数は随意で、任意の順序で指定できます。
それらすべては形式 <code>key=val</code>を取ります。
キーワード引数は:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。limitは使用する部分区間の最大数。デフォルトは200。
</p></dd>
</dl>

<p><code>quad_qagc</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p>
</dd>
</dl>

<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qawc (2^(-5)*((x-1)^2+4^(-5))^(-1), x, 2, 0, 5,
                 'epsrel=1d-7);
(%o1)    [- 3.130120337415925, 1.306830140249558E-8, 495, 0]
(%i2) integrate (2^(-alpha)*(((x-1)^2 + 4^(-alpha))*(x-2))^(-1),
      x, 0, 5);
Principal Value
                       alpha
        alpha       9 4                 9
       4      log(------------- + -------------)
                      alpha           alpha
                  64 4      + 4   64 4      + 4
(%o2) (-----------------------------------------
                        alpha
                     2 4      + 2

       3 alpha                       3 alpha
       -------                       -------
          2            alpha/2          2          alpha/2
    2 4        atan(4 4       )   2 4        atan(4       )   alpha
  - --------------------------- - -------------------------)/2
              alpha                        alpha
           2 4      + 2                 2 4      + 2
(%i3) ev (%, alpha=5, numer);
(%o3)                    - 3.130120337415917
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqawf"></a>
<a name="Item_003a-quad_005fqawf"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qawf</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawf</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>omega</var>, <var>trig</var>, [<var>epsabs</var>, <var>limit</var>, <var>maxp1</var>, <var>limlst</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawf</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>omega</var>, <var>trig</var>, [<var>epsabs</var>, <var>limit</var>, <var>maxp1</var>, <var>limlst</var>])</i>
<a name="IDX771"></a>
</dt>
<dd><p>フーリエコサイン変換またはフーリエサイン変換を、
Quadpack QAWF関数を使って、半無限区間上で計算します。
<code>quad_qawo</code>で使われるのと同じアプローチが、連続する区間に適用され、
イプシロンアルゴリズム(Wynn, 1956)を使った収束の促進が積分寄与の級数に適用されます。
</p>
<p><code>quad_qawf</code>は積分
<em>integrate (f(x)*w(x), x, a, inf)</em>
を計算します。
</p>
<p>重み関数 <em>w</em>が <var>trig</var>によって以下のように選択されます:
</p>
<dl compact="compact">
<dt> <code>cos</code></dt>
<dd><p><em>w(x) = cos (omega x)</em>
</p></dd>
<dt> <code>sin</code></dt>
<dd><p><em>w(x) = sin (omega x)</em>
</p></dd>
</dl>

<p>被積分関数は、 Maximaか Lispの関数か演算子の名前であるか、
Maximaのラムダ式か Maximaの一般式として指定することができます。
</p>
<p>キーワード引数は随意で、任意の順序で指定できます。
それらすべては形式 <code>key=val</code>を取ります。
キーワード引数は:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。(<var>limit</var> - <var>limlst</var>)/2は使用する部分区間の最大数。デフォルトは200。
</p></dd>
<dt> <code>maxp1</code></dt>
<dd><p>チェビシェフ積率の最大数。
0より大きくなければいけません。
デフォルトは100です。
</p></dd>
<dt> <code>limlst</code></dt>
<dd><p>サイクル数に関する上限。
3以上でなければいけません。
デフォルトは10です。
</p></dd>
</dl>

<p><code>quad_qawf</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p>
</dd>
</dl>

<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qawf (exp(-x^2), x, 0, 1, 'cos, 'epsabs=1d-9);
(%o1)   [.6901942235215714, 2.84846300257552E-11, 215, 0]
(%i2) integrate (exp(-x^2)*cos(x), x, 0, inf);
                          - 1/4
                        %e      sqrt(%pi)
(%o2)                   -----------------
                                2
(%i3) ev (%, numer);
(%o3)                   .6901942235215714
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqawo"></a>
<a name="Item_003a-quad_005fqawo"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qawo</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawo</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>omega</var>, <var>trig</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>, <var>maxp1</var>, <var>limlst</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qawo</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>omega</var>, <var>trig</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>, <var>maxp1</var>, <var>limlst</var>])</i>
<a name="IDX772"></a>
</dt>
<dd><p><em>cos(omega x) f(x)</em>
や
<em>sin(omega x) f(x)</em>
の有限の区間上の積分。
ここで、
<em>omega</em>
は定数です。
規則評価構成要素は変形 Clenshaw-Curtis手法に基づいています。
<code>quad_qawo</code>は<code>quad_qags</code>に似て、外挿とともに適応再分割を適用します。
</p>
<p><code>quad_qawo</code>は Quadpack QAWOルーチンを使って積分を計算します:
</p>
<p><em>integrate (f(x)*w(x), x, a, b)</em>
</p>
<p>重み関数 <em>w</em>が <var>trig</var>によって以下のように選択されます:
</p>
<dl compact="compact">
<dt> <code>cos</code></dt>
<dd><p><em>w(x) = cos (omega x)</em>
</p></dd>
<dt> <code>sin</code></dt>
<dd><p><em>w(x) = sin (omega x)</em>
</p></dd>
</dl>

<p>被積分関数は Maximaか Lispの関数か演算子の名前であるか、
Maximaのラムダ式か Maximaの一般式として指定することができます。
</p>
<p>キーワード引数は随意で、任意の順序で指定できます。
それらすべては形式 <code>key=val</code>を取ります。
キーワード引数は:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。<var>limit</var>/2は使用する部分区間の最大数。デフォルトは200。
</p></dd>
<dt> <code>maxp1</code></dt>
<dd><p>チェビシェフ積率の最大数。
0より大きくなければいけません。
デフォルトは100です。
</p></dd>
<dt> <code>limlst</code></dt>
<dd><p>サイクル数に関する上限。
3以上でなければいけません。
デフォルトは10です。
</p></dd>
</dl>

<p><code>quad_qawo</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p></dd>
</dl>

<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qawo (x^(-1/2)*exp(-2^(-2)*x), x, 1d-8, 20*2^2, 1, cos);
(%o1)     [1.376043389877692, 4.72710759424899E-11, 765, 0]
(%i2) rectform (integrate (x^(-1/2)*exp(-2^(-alpha)*x) * cos(x),
      x, 0, inf));
                   alpha/2 - 1/2            2 alpha
        sqrt(%pi) 2              sqrt(sqrt(2        + 1) + 1)
(%o2)   -----------------------------------------------------
                               2 alpha
                         sqrt(2        + 1)
(%i3) ev (%, alpha=2, numer);
(%o3)                     1.376043390090716
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqaws"></a>
<a name="Item_003a-quad_005fqaws"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qaws</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qaws</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>alpha</var>, <var>beta</var>, <var>wfun</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qaws</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>alpha</var>, <var>beta</var>, <var>wfun</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX773"></a>
</dt>
<dd><p><em>w(x) f(x)</em>の有限の区間上の積分。
ここで <em>w(x)</em>はある代数的または対数関数です。
大域的適応最分割戦略が適用されます。
積分の区間の端点を含む部分区間上で変形 Clenshaw-Curtis積分を使います。
</p>
<p><code>quad_qaws</code>は Quadpack QAWSルーチンを使って積分を計算します:
</p>
<p><em>integrate (f(x)*w(x), x, a, b)</em>
</p>
<p>重み関数 <em>w</em>が <var>wfun</var>によって以下のように選択されます:
</p>
<dl compact="compact">
<dt> <code>1</code></dt>
<dd><p><em>w(x) = (x - a)^alpha (b - x)^beta</em>
</p></dd>
<dt> <code>2</code></dt>
<dd><p><em>w(x) = (x - a)^alpha (b - x)^beta log(x - a)</em>
</p></dd>
<dt> <code>3</code></dt>
<dd><p><em>w(x) = (x - a)^alpha (b - x)^beta log(b - x)</em>
</p></dd>
<dt> <code>4</code></dt>
<dd><p><em>w(x) = (x - a)^alpha (b - x)^beta log(x - a) log(b - x)</em>
</p></dd>
</dl>

<p>被積分関数は Maximaか Lispの関数か演算子の名前であるか、
Maximaのラムダ式か Maximaの一般式として指定することができます。
</p>
<p>キーワード引数は随意で、任意の順序で指定できます。
それらすべては形式 <code>key=val</code>を取ります。
キーワード引数は:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>望まれる近似の相対誤差。デフォルトは1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>望まれる近似の絶対誤差。デフォルトは0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。 <var>limit</var>は使用する部分区間の最大数。デフォルトは200。
</p></dd>
</dl>

<p><code>quad_qaws</code>は４つの要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似
</li><li>
見積もられた近似の絶対誤差
</li><li>
非積分関数の評価数
</li><li>
エラーコード
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p>
</dd>
</dl>

<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qaws (1/(x+1+2^(-4)), x, -1, 1, -0.5, -0.5, 1,
                 'epsabs=1d-9);
(%o1)     [8.750097361672832, 1.24321522715422E-10, 170, 0]
(%i2) integrate ((1-x*x)^(-1/2)/(x+1+2^(-alpha)), x, -1, 1);
       alpha
Is  4 2      - 1  positive, negative, or zero?

pos;
                          alpha         alpha
                   2 %pi 2      sqrt(2 2      + 1)
(%o2)              -------------------------------
                               alpha
                            4 2      + 2
(%i3) ev (%, alpha=4, numer);
(%o3)                     8.750097361672829
</pre></td></tr></table>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>


<p><a name="quad_005fqagp"></a>
<a name="Item_003a-quad_005fqagp"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_qagp</b><i> &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qagp</tt> (<var>f(x)</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>points</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>]) &nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<tt>quad_qagp</tt> (<var>f</var>, <var>x</var>, <var>a</var>, <var>b</var>, <var>points</var>, [<var>epsrel</var>, <var>epsabs</var>, <var>limit</var>])</i>
<a name="IDX774"></a>
</dt>
<dd><p>有限区間上の一般的な関数の積分。
<code>quad_qagp</code>は、
Epsilonアルゴリズム (Wynn, 1956)による外挿を使った大域的に適応的な区間部分分割
(de Doncker, 1978)を実装します。
</p>
<p><code>quad_qagp</code>は積分
</p>
<p><em>integrate (f(x), x, a, b)</em>
を計算します。
</p>
<p>被積分関数は従属変数 <var>x</var>を持つ <var>f(x)</var>で、
関数は端点 <var>a</var>と <var>b</var>の間で積分されます。
</p>
<p>被積分関数は
Maximaか Lispの関数か演算子の名前か、Maximaのラムダ式、一般の Maxima式として
指定できます。
</p>
<p>積分器を助けるため、
ユーザーは被積分関数の特異点や不連続点を提供しなければいけません。
</p>
<p>キーワード引数はオプションで、
どんな順序でも指定できます。
それらはすべて <code>key=val</code>の形を取ります。
キーワード引数は以下の通りです:
</p>
<dl compact="compact">
<dt> <code>epsrel</code></dt>
<dd><p>所望の近似の相対誤差。デフォルトは 1d-8。
</p></dd>
<dt> <code>epsabs</code></dt>
<dd><p>所望の近似の絶対誤差。デフォルトは 0。
</p></dd>
<dt> <code>limit</code></dt>
<dd><p>内部の作業配列のサイズ。
<var>limit</var>は使われる部分区間の最大数です。
デフォルトは 200。
</p></dd>
</dl>

<p><code>quad_qagp</code>は4要素のリストを返します:
</p>
<ul class="toc">
<li>
積分の近似,
</li><li>
近似の絶対誤差の見積もり,
</li><li>
被積分関数の評価数,
</li><li>
エラーコード。
</li></ul>

<p>エラーコード(戻り値の４番目の要素)は以下の値を取ります:
</p>
<dl compact="compact">
<dt> <code>0</code></dt>
<dd><p>問題が発生しなかった場合;
</p></dd>
<dt> <code>1</code></dt>
<dd><p>部分区間の数が上限を超えた場合;
</p></dd>
<dt> <code>2</code></dt>
<dd><p>丸め誤差が超過した場合;
</p></dd>
<dt> <code>3</code></dt>
<dd><p>非積分関数の振る舞いが極端に悪い場合;
</p></dd>
<dt> <code>4</code></dt>
<dd><p>収束に失敗した場合;
</p></dd>
<dt> <code>5</code></dt>
<dd><p>積分が発散しているか収束が遅い場合;
</p></dd>
<dt> <code>6</code></dt>
<dd><p>入力が無効な場合;
</p>
</dd>
</dl>


<p>例:
</p>
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) quad_qagp(x^3*log(abs((x^2-1)*(x^2-2))),x,0,3,[1,sqrt(2)]);
(%o1)   [52.74074838347143, 2.6247632689546663e-7, 1029, 0]
(%i2) quad_qags(x^3*log(abs((x^2-1)*(x^2-2))), x, 0, 3);
(%o2)   [52.74074847951494, 4.088443219529836e-7, 1869, 0]
</pre></td></tr></table>
<p>被積分関数は <code>1</code>と <code>sqrt(2)</code>で特異性を持つので
これらの点を <code>quad_qagp</code>に提供します。
<code>quad_qagp</code>は <code><a href="#quad_005fqags">quad_qags</a></code>より精確で効率的であることも特筆します。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>

<p><a name="quad_005fcontrol"></a>
<a name="Item_003a-quad_005fcontrol"></a>
</p><dl>
<dt><u>関数:</u> <b>quad_control</b><i> (<var>parameter</var>, [<var>value</var>])</i>
<a name="IDX775"></a>
</dt>
<dd><p>quadpackのエラーハンドリングを制御します。
パラメータは以下のシンボルのどれかでなければいけません:
</p>
<dl compact="compact">
<dt> <code>current_error</code></dt>
<dd><p>現在のエラー数
</p></dd>
<dt> <code>control</code></dt>
<dd><p>メッセージを印字するかしないか制御します。
ゼロ以下に設定すると、メッセージは抑制されます。
</p></dd>
<dt> <code>max_message</code></dt>
<dd><p>メッセージを印字する最大回数。
</p></dd>
</dl>

<p><var>value</var>を与えないと <var>parameter</var>の現在の値を返します。
<var>value</var>を与えると <var>parameter</var>の値に与えられた値を設定します。
</p>
<div class=categorybox>

<p>Categories:&nbsp;&nbsp;<a href="maxima_106.html#Category_003a-Numerical-methods">Numerical methods</a> &middot;
<a href="maxima_106.html#Category_003a-Package-quadpack">Package quadpack</a>
</div>
</p></dd></dl>

<p><a name="Item_003a-Equations"></a>
</p><hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC98" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_20.html#SEC104" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_90.html#SEC429" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>市川雄二</em> on <em>October, 5 2017</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
